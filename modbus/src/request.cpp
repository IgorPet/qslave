#include    "request.h"

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
quint8 hiByte(quint16 word)
{
    return static_cast<quint8>( (word & 0xFF00) >> 8);
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
quint8 loByte(quint16 word)
{
    return static_cast<quint8>(word & 0x00FF);
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
quint16 word(quint8 hiByte, quint8 loByte)
{
    quint16 result = static_cast<quint16>(loByte);
    result = result | static_cast<quint16>(hiByte << 8);

    return result;
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
void setBit(quint8 &byte, quint8 bit)
{
    byte |= (1 << bit);
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
quint16 calcCRC16(char *buff, quint8 size)
{
    quint32 tmp, tmp2, flag;

    tmp = 0xFFFF;

    for (quint8 i = 0; i < size; i++)
    {
        tmp = tmp ^ buff[i];

        for (quint8 j = 1; j <= 8; j++)
        {
            flag = tmp & 0x0001;
            tmp >>= 1;

            if (flag)
                tmp ^= 0xA001;
        }
    }

    tmp2 = tmp >> 8;
    tmp = (tmp << 8) | tmp2;
    tmp &= 0xFFFF;

    return tmp;
}

//------------------------------------------------------------------------------
//
//------------------------------------------------------------------------------
bool getBit(quint8 byte, quint8 bit)
{
    quint8 mask = (1 << bit);
    quint8 result = byte & mask;

    return static_cast<bool>(result);
}
